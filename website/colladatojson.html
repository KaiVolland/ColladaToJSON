<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta http-equiv="X-UA-Compatible" content="chrome=1"/>
<link rel="stylesheet" type="text/css" href="styles.css">
<link rel="stylesheet" type="text/css" href="jQuery/css/smoothness/jquery-ui-1.8.18.custom.css">
<title>OpenWebGlobe SDK: Collada to JSON Converter</title>

<script type="text/javascript"   src="jQuery/jquery-1.7.1.min.js"></script>
    <script type="text/javascript"   src="jQuery/jquery-ui-1.8.18.custom.min.js"></script>
<script type="text/javascript">





    function updateProgress(evt)
    {
       console.log("Processing");
    }

    function errorHandler(evt)
    {
        console.log("Error ("+evt.target.error.code+")");
    }


    function conversionStart()
    {
        var formElement = document.getElementById("frmForumlar");
        var formData = new FormData(formElement);
        formData.append("part_description", "The best part ever!");

        var xhr = new XMLHttpRequest();
        xhr.open("POST", "http://localhost:8000/");
        xhr.onreadystatechange = cbfConversion;
        xhr.send(formData);
        jQuery("#divWaiting").show();

    }


    function cbfConversion()
    {
        console.log("readyState: "+this.readyState+"  this.status: "+this.status);
        /*handle progress events here */
        if (this.readyState == 4 && this.status == 200)
        {
            var answer = this.responseText;
            jQuery("#divWaiting").hide();
            jQuery("#divMainEntry").enable();

            if(answer.indexOf("error")>=0)
            {
                jQuery( "#divErrorDialog" ).html("<p>"+answer+"</p>");
                jQuery( "#divErrorDialog" ).dialog({
                    modal: true,
                    buttons: {
                        Ok: function() {
                            $( this ).dialog( "close" );
                        }
                    }
                });
            }
            else
            {
                window.open(answer);
            }

        }

    }


//----------------------------------------------------------------------------------------------------------------------
    $(function() {
        jQuery( "#divMainEntry" ).tabs();
        jQuery("#tbPosition").hide();
        jQuery("#divErrorDialog").hide();
        jQuery("#divWaiting").hide().css({ opacity: 0.75 });;

    });

    function cbfSubmit()
    {

        window.location.reload(true);

    }

    function cbfFileChanged()
    {
        //check the file ending -> if dae set positon update visible

        var filepicker = document.getElementById("input_file");
        var filename = filepicker.value;
        var fileending = filename.split('.')[1];

        if(fileending=='dae')
        {
            jQuery("#tbPosition").slideDown("slow");
        }
        else
        {
            jQuery("#tbPosition").slideUp("slow");
        }
    }

    function cbfload()
    {
        alert("loadeld");
    }


</script>

</head>
<body onload>

    <div id="divErrorDialog" title="Error"></div>

    

    <div id="divMainEntry">
        <ul>
            <li><a href="#tabs-1">The OpenWebGlobe Collada to JSON Converter</a></li>
        </ul>
        <div id="tabs-1">
            <div id="divWaiting"><div id="divWaitingImage"><img src="ajax-loader.gif" /></div> </div>
            <form id="frmForumlar"> <!--action="http://localhost:8000/" enctype="multipart/form-data" method="post">-->
            <br>
            <p>Select a Collada (*.dae) file.</p>
            <input id="input_file" onchange="cbfFileChanged()" name="datafile" type="file" size="60" maxlength="100000" accept="text/*" />
            <br><br>
            <div id="tbPosition">

                            Longitude: <input name="lng" id="input_lng" size="10" type="text" value="0.0"/>

                            Latitude: <input name="lat" size="10" type="text" value="0.0"/>


                            Elevation: <input  name="elv" size="10" type="text" value="0.0"/>

            </div>
            <input onclick="conversionStart()" type="button" value="Convert">
            </form>
        </div>
    </div>








</body>

